/*
 * mi_dialogs.js for making dialogs
 *
 * @package       base
 * @copyright     Copyright (c) 2009, Andy Dawson
 * @link          www.ad7six.com
 * @license       http://www.opensource.org/licenses/mit-license.php The MIT License
 */
$(function(){$("a.confirm").addClass("dialog modal");$(".dialogs a, a.dialog, .popup a, a.popup, a.popout").click(function(){return d(this)});function c(e){b(e);a(e)}function b(e){var e=$(e);$("a",e).click(function(){return d($(this),e)})}function a(e){var e=$(e);$("form",e).bind("submit",function(){$(this).ajaxSubmit({target:e,success:function(f){e.html(f);a(e);$("a",e).click(function(){return d($(this))})},});return false})}function d(e,i){e=$(e);if(i){i=$(i)}var j=e.attr("title");if(!j){j=e.text()}var g=e.attr("href");if(g[0]=="#"){g=g.replace(/[#]/g,"")}else{g="mialog-"+g.replace(/[\/]/g,"")}if(i&&e.hasClass("breakout")){return}else{if(!i||e.hasClass("popout")){var h=$("#"+g);if(h.length){if(!h.parent(".ui-dialog").length){h.attr("title",j).dialog({width:"auto",height:"auto",modal:e.hasClass("modal")?true:false,resizable:e.hasClass("noResize")?false:true,draggable:e.hasClass("noDrag")?false:true})}h.dialog("open");return false}h=$('<div class="dialog"></div>');h.attr("title",j).attr("id",g).appendTo("body").load(e.attr("href")+".ajax?layout=dialog",function(m){c(h);h.dialog({width:"auto",height:"auto",modal:e.hasClass("modal")?true:false,resizable:e.hasClass("noResize")?false:true,draggable:e.hasClass("noDrag")?false:true});var l=$(".ui-dialog-titlebar",h.parent());if(g[0]!="#"){var k=$('<a><span class="ui-icon ui-icon-arrowthick-1-ne"></span></a>').addClass("leavePopup breakout ui-corner-all").attr("href",e.attr("href")).attr("title",sprintf(__("Open in a new window (%s)"),e.attr("href"))).attr("target","_blank").hover(function(){k.addClass("ui-state-hover")},function(){k.removeClass("ui-state-hover")}).focus(function(){k.addClass("ui-state-focus")}).blur(function(){k.removeClass("ui-state-focus")}).appendTo(l)}})}else{var f=$(".ui-dialog-titlebar",i.parent());i.attr("id",g).css("width",i.width()+"px").css("height",i.height()+"px").load(e.attr("href")+".ajax?layout=dialog",function(k){$(".ui-dialog-title",f).text(j);$(".leavePopup",f).attr("href",e.attr("href")).attr("title",sprintf(__("Open in a new window (%s)"),e.attr("href")));c(i)})}}return false}});
